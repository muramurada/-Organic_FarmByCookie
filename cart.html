<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="./css/reset.css" rel="stylesheet" media="all" />
    <link href="./css/cart.css" rel="stylesheet" media="all" />
    <!-- icons -->
    <link rel="icon" href="img/hero_img.png">
    <!-- <link rel="icon" sizes="192x192" href="img/hero_img.png"> -->
    <title>Document</title>
  </head>
  <body>
    <p>Cart</p>
    <form class="cart-form" action="./php/cart.php" method="POST">
      <div>
        <label for="num_nasu">茄子（１００円）：</label>
        <input type="number" name="num_nasu" id="num_nasu" />個
      </div>
      <div>
        <label for="num_tomato">トマト（２００円）：</label>
        <input type="number" name="num_tomato" id="num_tomato" />個
      </div>
      <div>
        <label for="num_cucumber">キュウリ（３００円）：</label>
        <input type="number" name="num_cucumber" id="num_cucumber" />個
      </div>
      <div>
        <label for="total">合計：</label>
        <input type="number" name="total" id="total" />円
      </div>
      <button class="purchase" type="submit">購入</button>
    </form>
    <a href="./index.html"
      ><img id="fixed" src="./img/kkrn_icon_modoru_3.png"
    /></a>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script>
      var num_nasu = $.cookie("num_nasu");
      var num_tomato = $.cookie("num_tomato");
      var num_cucumber = $.cookie("num_cucumber");
      document.getElementById("num_nasu").value = num_nasu;
      document.getElementById("num_tomato").value = num_tomato;
      document.getElementById("num_cucumber").value = num_cucumber;

      var total = 100 * num_nasu + 200 * num_tomato + 300 * num_cucumber;
      document.getElementById("total").value = total;
      var eventNumNasu = document.querySelector("#num_nasu");
      var eventNumTomato = document.querySelector("#num_tomato");
      var eventNumCucumber = document.querySelector("#num_cucumber");
      eventNumNasu.addEventListener("input", function () {
        num_nasu = document.getElementById("num_nasu").value;
        $.cookie("num_nasu", num_nasu);
        console.log($.cookie("num_nasu"));
        total = 100 * num_nasu + 200 * num_tomato + 300 * num_cucumber;
        document.getElementById("total").value = total;
      });
      eventNumTomato.addEventListener("input", function () {
        num_tomato = document.getElementById("num_tomato").value;
        $.cookie("num_tomato", num_tomato);
        total = 100 * num_nasu + 200 * num_tomato + 300 * num_cucumber;
        document.getElementById("total").value = total;
      });
      eventNumCucumber.addEventListener("input", function () {
        num_cucumber = document.getElementById("num_cucumber").value;
        $.cookie("num_cucumber", num_cucumber);
        total = 100 * num_nasu + 200 * num_tomato + 300 * num_cucumber;
        document.getElementById("total").value = total;
      });
      //クエリ文字列から値を取り出す関数
      function getParam(name, url) {
        url = window.location.href; //URLの取得
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)");
        var results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return "";
        return decodeURIComponent(results[2].replace(/\+/g, " "));
      }
    </script>
  </body>
</html>
